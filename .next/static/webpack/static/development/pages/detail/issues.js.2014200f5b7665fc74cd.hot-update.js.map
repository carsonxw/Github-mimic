{"version":3,"file":"static/webpack/static/development/pages/detail/issues.js.2014200f5b7665fc74cd.hot-update.js","sources":["webpack:///./components/with-repo-basic.jsx"],"sourcesContent":["import { useEffect } from 'react';\nimport Repo from './Repos';\nimport Link from 'next/link';\nimport { withRouter } from 'next/router';\n\nimport { getRepo, cacheRepo } from '../lib/repo-basic-cache';\n\nconst api = require('../lib/api');\n\nconst isServer = typeof window === 'undefined';\n\n//help function to concat query string\nfunction makeQuery(queryObject) {\n    const query = Object.entries(queryObject).reduce(\n        (result, entry) => {\n            result.push(entry.join('='));\n            return result;\n        }, []).join('&');\n    return `?${query}`;\n}\n\nexport default function (Comp, type = 'readme') {\n    function WithDetail({ repoBasic, router, ...rest }) {\n        console.log(repoBasic);\n        const query = makeQuery(router.query);\n\n        useEffect(() => {\n            !isServer && cacheRepo(repoBasic.data);\n        })\n\n        return (\n            <div c lassName=\"root\">\n                <div className=\"repo-basic\">\n                    <Repo repo={repoBasic}/>\n                    <div className=\"tabs\">\n                        {\n                            type === 'readme' ? \n                                <span className='tab'>Readme</span> : \n                                <Link href={`/detail${query}`}>\n                                    <a className=\"tab readme\">Readme </a>\n                                </Link>\n                        }\n                        {\n                            type === 'issues' ? \n                                <span className='tab'>Issues</span>:\n                                <Link href={`/detail/issues${query}`}>\n                                    <a href=\"\" className=\"tab issues\">Issues</a>\n                                </Link>\n                        }\n                        \n                    </div>\n                </div>\n                <div>\n                    <Comp { ... rest }/>\n                </div>\n                <style jsx>{`\n                    .root {\n                        padding-top: 20px;\n                    }\n                    .repo-basic {\n                        padding: 20px;\n                        border: 1px solid #eee;\n                        margin-bottom: 20px;\n                        border-radius: 5px;\n                    }\n                    .tab + .tab {\n                        margin-left: 20px;\n                    }\n                `}</style>\n            </div>\n        )\n    }\n    \n    WithDetail.getInitialProps = async (context) => {\n        console.log('context', context);\n        const { router, ctx } = context;\n        const { owner, name } = ctx.query;\n\n        const full_name = `${owner}/${name}`;\n        const repo = getRepo(full_name);\n        \n        let pageData = {} ;\n        if (Comp.getInitialProps) {\n            pageData = await Comp.getInitialProps(context);\n        }\n        \n        //get cache\n        if (repo) {\n            return {\n                repoBasic: repo,\n                ... pageData,\n            }\n        }\n\n        const repoBasic = await api.request({\n                url: `/repos/${owner}/${name}`, \n            },\n            ctx.req,\n            ctx.res\n        );\n\n        return {\n            repoBasic: repoBasic.data,\n            ... pageData\n        }\n    };\n\n    return withRouter(WithDetail) ;\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAGA;AAAA;AACA;AAAA;AACA;AAAA;AAKA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAMA;AAAA;AArBA;AAAA;AAwCA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAKA;AACA;AAEA;AACA;AATA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAUA;AACA;AAXA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAgBA;AAhBA;AACA;AADA;AAAA;AAAA;AAsBA;AADA;AACA;AAtBA;AAqBA;AArBA;AA6BA;AA7BA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAiCA;AACA;;;;A","sourceRoot":""}