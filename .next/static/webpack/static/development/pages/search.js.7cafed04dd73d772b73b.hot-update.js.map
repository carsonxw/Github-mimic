{"version":3,"file":"static/webpack/static/development/pages/search.js.7cafed04dd73d772b73b.hot-update.js","sources":["webpack:///./pages/search.js"],"sourcesContent":["import { withRouter } from 'next/router';\nimport { Row, Col, List } from 'antd';\nimport Router from 'next/router';\n\nconst api = require('../lib/api');\n\nconst LANGUAGE = [\n    'JavaScript',\n    'HTML',\n    'CSS',\n    'TypeScript',\n    'Java',\n    'Rust',\n];\n\nconst SORT_TYPES = [\n    {\n        name: 'Best Match'\n    },\n    {\n        name: 'Most Stars',\n        value: 'starts',\n        order: 'desc'\n    },\n    {\n        name: 'Fewest Stars',\n        value: 'starts',\n        order: 'asc'\n    },\n    {\n        name: 'Most Forks',\n        value: 'forks',\n        order: 'desc'\n    },\n    {\n        name: 'Fewest Forks',\n        value: 'forks',\n        order: 'asc'\n    }\n];\n\n/**\n * sort: 排序方式\n * order: 排序顺序\n * lang: 仓库项目开发主语言\n * page: 分页页面\n */\n\nfunction Search({ router, repos }) {\n    //get query\n    console.log(repos);\n    console.log(router);\n\n    const { sort, order, lang } = router.query;\n\n    const handleLanguageChange = language => {\n         Router.push({\n             pathname: '/search',\n             query: {\n                 lang: language,\n                 sort,\n                 order\n             }\n         });\n    }\n\n    const handleSortedChange = sort => {\n        Router.push({\n            pathname: '/search',\n            query: {\n                lang,\n                sort: sort.value,\n                order: sort.order\n            }\n        });\n    }\n\n    return (\n        <div className=\"root\">\n            <Row gutter={20}>\n                <Col span={6}>\n                    <List \n                        bordered\n                        header={<span className=\"list-header\">Language</span>}\n                        style={{ marginBottom: 20 }}\n                        dataSource={LANGUAGE}\n                        renderItem={item => {\n                            return (\n                                <List.Item>\n                                    <a onClick={() => handleLanguageChange(item)}>{item}</a>\n                                </List.Item>\n                            )\n                        }}\n                    />\n                    <List \n                        bordered\n                        header={<span className=\"list-header\">Sorted</span>}\n                        dataSource={SORT_TYPES}\n                        renderItem={item => {\n                            return (\n                                <List.Item>\n                                    <a onClick={() => handleSortedChange(item)}>{item.name}</a>\n                                </List.Item>\n                            )\n                        }}\n                    />\n                </Col>\n            </Row>\n        </div>\n    )\n}\n\nSearch.getInitialProps = async ({ ctx }) => {\n    const { query, sort, lang, order, page } = ctx.query;\n    \n    if (!query) {\n        return {\n            repos: {\n                total_count: 0\n            }\n        }\n    }\n\n    // ?q=react+language:javascript&sort=stars&order=desc&page=2;\n    let queryString = `?q=${query}`;\n    if (lang) queryString += `+language:${lang}`;\n    if (sort) queryString += `&sort=${sort}&order=${order || 'desc' }`;\n    if (page) queryString += `page=${page}`;\n\n    const result = await api.request({\n        url: `/search/repositories${queryString}`\n    }, ctx.req, ctx.res);\n\n    return {\n        repos: result.data\n    }\n}\n\nexport default withRouter(Search);"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAEA;AACA;AACA;AACA;AACA;AASA;AAEA;AADA;AAIA;AACA;AACA;AAHA;AAMA;AACA;AACA;AAHA;AAMA;AACA;AACA;AAHA;AAMA;AACA;AACA;AAHA;AAOA;;;;;;;AAOA;AAAA;AAAA;AACA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAFA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAFA;AAQA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAGA;AAXA;AAcA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAGA;AAVA;AAgBA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAKA;AACA;AADA;AADA;AACA;AALA;AAWA;AACA;AACA;AACA;AACA;AAfA;AAAA;AAkBA;AADA;AACA;AAlBA;AAiBA;AAjBA;AAsBA;AADA;AACA;AAtBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAyBA;;;;A","sourceRoot":""}